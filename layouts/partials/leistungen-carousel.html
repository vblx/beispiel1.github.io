<!-- leistungen-carousel.html -->
<section id="fh5co-work" data-section="work">
  <div class="container">
    <div class="row">
      <div class="col-md-12 section-heading text-center">
        <h2 class="to-animate">{{ with .Site.Params.work.title }}{{ . }}{{ end }}</h2>
        <div class="row">
          <div class="col-md-8 col-md-offset-2 subtext to-animate">
            <h3>{{ with .Site.Params.work.description }}{{ . | markdownify }}{{ end }}</h3>
          </div>
        </div>
      </div>
    </div>

    <div class="carousel-container">
      <div class="carousel-wrapper">
        <!-- Overview Slide -->
        <div class="carousel-slide" data-slide="overview">
          <div class="row">
            <div class="col-md-6">
              <img src="images/work-overview.jpg" alt="Leistungen Überblick" class="img-responsive">
            </div>
            <div class="col-md-6">
              <h3>Unsere Leistungen im Überblick</h3>
              <p>{{ .Site.Params.work.overview_text }}</p>
            </div>
          </div>
        </div>

        <!-- Hochbau Slide -->
        <div class="carousel-slide" data-slide="work1" id="hochbau-slide">
          <div class="row">
            <div class="col-md-6">
              <img src="images/work-hochbau.jpg" alt="Hochbau" class="img-responsive">
            </div>
            <div class="col-md-6">
              <h3>{{ .Site.Params.navigation.work1 }}</h3>
              <p>{{ .Site.Params.work.hochbau_text }}</p>
            </div>
          </div>
        </div>

        <!-- Tiefbau Slide -->
        <div class="carousel-slide" data-slide="work2" id="tiefbau-slide">
          <div class="row">
            <div class="col-md-6">
              <img src="images/work-tiefbau.jpg" alt="Tiefbau" class="img-responsive">
            </div>
            <div class="col-md-6">
              <h3>{{ .Site.Params.navigation.work2 }}</h3>
              <p>{{ .Site.Params.work.tiefbau_text }}</p>
            </div>
          </div>
        </div>

        <!-- Glasfaser Slide -->
        <div class="carousel-slide" data-slide="work3" id="glasfaser-slide">
          <div class="row">
            <div class="col-md-6">
              <img src="images/work-glasfaser.jpg" alt="Glasfaser" class="img-responsive">
            </div>
            <div class="col-md-6">
              <h3>{{ .Site.Params.navigation.work3 }}</h3>
              <p>{{ .Site.Params.work.glasfaser_text }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Navigation Controls -->
      <button class="carousel-nav prev" aria-label="Previous slide">❮</button>
      <button class="carousel-nav next" aria-label="Next slide">❯</button>

      <!-- Slide Indicators -->
      <div class="carousel-indicators">
        <button class="indicator active" data-slide="overview"></button>
        <button class="indicator" data-slide="work1"></button>
        <button class="indicator" data-slide="work2"></button>
        <button class="indicator" data-slide="work3"></button>
      </div>
    </div>
  </div>
</section>

<style>
.carousel-container {
  position: relative;
  max-width: 100%;
  margin: 2rem auto;
  overflow: hidden;
}

.carousel-wrapper {
  display: flex;
  transition: transform 0.5s ease-in-out;
}

.carousel-slide {
  flex: 0 0 100%;
  padding: 1rem;
  opacity: 0;
  transition: opacity 0.5s ease-in-out;
}

.carousel-slide.active {
  opacity: 1;
}

.carousel-nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0, 0, 0, 0.5);
  color: white;
  border: none;
  padding: 1rem;
  cursor: pointer;
  transition: background 0.3s;
}

.carousel-nav:hover {
  background: rgba(0, 0, 0, 0.8);
}

.carousel-nav.prev {
  left: 0;
}

.carousel-nav.next {
  right: 0;
}

.carousel-indicators {
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
}

.carousel-indicators button {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  border: none;
  background: #ccc;
  cursor: pointer;
}

.carousel-indicators button.active {
  background: #333;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const wrapper = document.querySelector('.carousel-wrapper');
  const slides = document.querySelectorAll('.carousel-slide');
  const indicators = document.querySelectorAll('.carousel-indicators button');
  const prevBtn = document.querySelector('.carousel-nav.prev');
  const nextBtn = document.querySelector('.carousel-nav.next');
  let currentSlide = 0;
  let autoplayInterval;

  function updateSlide(index) {
    wrapper.style.transform = `translateX(-${index * 100}%)`;
    slides.forEach((slide, i) => {
      slide.classList.toggle('active', i === index);
    });
    indicators.forEach((indicator, i) => {
      indicator.classList.toggle('active', i === index);
    });
    currentSlide = index;
  }

  function startAutoplay() {
    autoplayInterval = setInterval(() => {
      const nextIndex = (currentSlide + 1) % slides.length;
      updateSlide(nextIndex);
    }, 5000);
  }

  function stopAutoplay() {
    clearInterval(autoplayInterval);
  }

  // Navigation controls
  prevBtn.addEventListener('click', () => {
    stopAutoplay();
    const prevIndex = (currentSlide - 1 + slides.length) % slides.length;
    updateSlide(prevIndex);
    startAutoplay();
  });

  nextBtn.addEventListener('click', () => {
    stopAutoplay();
    const nextIndex = (currentSlide + 1) % slides.length;
    updateSlide(nextIndex);
    startAutoplay();
  });

  // Indicator controls
  indicators.forEach((indicator, index) => {
    indicator.addEventListener('click', () => {
      stopAutoplay();
      updateSlide(index);
      startAutoplay();
    });
  });

  // Handle navigation menu clicks
  document.querySelectorAll('[data-nav-section="work1"], [data-nav-section="work2"], [data-nav-section="work3"]').forEach(link => {
    link.addEventListener('click', (e) => {
      const section = e.target.getAttribute('data-nav-section');
      const slideIndex = Array.from(slides).findIndex(slide => slide.getAttribute('data-slide') === section);
      if (slideIndex !== -1) {
        stopAutoplay();
        updateSlide(slideIndex);
        startAutoplay();
      }
    });
  });

  // Initialize
  updateSlide(0);
  startAutoplay();
});
</script>
